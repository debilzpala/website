<script>
// ... (caÅ‚y kod prekodera, kopiowania, particles, toggleTheme, toggleLang zostaje bez zmian) ...
function toggleTheme(){ document.body.classList.toggle('light'); }

// particles
const c=document.getElementById('particles'),x=c.getContext('2d');
function resize(){c.width=innerWidth;c.height=innerHeight} resize(); onresize=resize;
let p=Array.from({length:60},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*2+1,s:Math.random()+.2}));
function anim(){ x.clearRect(0,0,c.width,c.height); p.forEach(a=>{x.beginPath();x.arc(a.x,a.y,a.r,0,7);x.fillStyle='rgba(150,180,255,.6)';x.fill();a.y+=a.s;if(a.y>c.height)a.y=0}); requestAnimationFrame(anim)} anim();

// MC server status - OSTATECZNA LOGIKA DLA ATERNOS
let lastOnline = undefined; 
function fetchStatus(){
Â  console.log('Sprawdzanie statusu serwera (Ostateczna logika Aternos)...');
Â  // PowrÃ³t do mcstatus.io
Â  fetch('https://api.mcstatus.io/v2/status/java/neoncraf_mc.aternos.me:34490')
Â  Â  .then(r => {
Â  Â  Â  if (!r.ok) {
Â  Â  Â  Â  console.error('BÅ‚Ä…d HTTP z mcstatus.io:', r.status, r.statusText);
Â  Â  Â  Â  throw new Error('BÅ‚Ä…d HTTP: ' + r.status);
Â  Â  Â  }
Â  Â  Â  return r.json();
Â  Â  })
Â  Â  .then(d=>{
      // Ustawienie bezpiecznych domyÅ›lnych wartoÅ›ci
      const isOnlineFromAPI = d.online === true;
      const onlinePlayers = d.players?.online ?? 0;
      const maxPlayers = d.players?.max ?? 0;
      
Â  Â  Â  let statusDisplay;
Â  Â  Â  let currentStatus; // true = gotowy do gry, false = w lobby/offline

Â  Â  Â  if (isOnlineFromAPI) {
Â  Â  Â  Â  Â  // Serwer w peÅ‚ni odpowiada (ONLINE)
Â  Â  Â  Â  Â  statusDisplay = 'ðŸŸ¢ ONLINE';
Â  Â  Â  Â  Â  currentStatus = true;
Â  Â  Â  } else if (d.host && d.port) { 
Â  Â  Â  Â  Â  // API odpowiedziaÅ‚o, ale online: false ORAZ mamy dane hosta. 
Â  Â  Â  Â  Â  // To oznacza, Å¼e serwer Aternos jest wÅ‚Ä…czony, ale w trybie oczekiwania.
Â  Â  Â  Â  Â  statusDisplay = 'ðŸŸ¡ CZEKANIE (LOBBY)';
Â  Â  Â  Â  Â  currentStatus = false;
Â  Â  Â  } else {
          // BÅ‚Ä…d, ale nie bÅ‚Ä…d sieci (np. API nie moÅ¼e znaleÅºÄ‡ hosta)
          statusDisplay = 'ðŸ”´ OFFLINE';
          currentStatus = false;
      }

Â  Â  Â  // Aktualizacja DOM
Â  Â  Â  document.getElementById('status').innerText = statusDisplay;
Â  Â  Â  document.getElementById('players').innerText = onlinePlayers + ' / ' + maxPlayers;
Â  Â  Â  document.getElementById('percent').innerText = maxPlayers ? ('ðŸ“Š ' + Math.round((onlinePlayers / maxPlayers) * 100) + '%') : '';
Â  Â  Â Â 
Â  Â  Â  // Logika Webhooka
Â  Â  Â  if(lastOnline === undefined) {
Â  Â  Â  Â  lastOnline = currentStatus;
Â  Â  Â  Â  return;Â 
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  if(lastOnline !== currentStatus) {
Â  Â  Â  Â  if (currentStatus) {
Â  Â  Â  Â  Â  Â  sendDiscord('ðŸŸ¢ **NeoNCraf ONLINE**\nSerwer zostaÅ‚ uruchomiony i jest gotowy do gry!');
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  sendDiscord('ðŸ”´ **NeoNCraf OFFLINE**\nSerwer wszedÅ‚ w tryb oczekiwania (LOBBY) lub zostaÅ‚ wyÅ‚Ä…czony.');
Â  Â  Â  Â  }
Â  Â  Â  Â  lastOnline = currentStatus;
Â  Â  Â  }
Â  Â  })
Â  Â  .catch(e=>{
Â  Â  Â  console.error('BÅ‚Ä…d poÅ‚Ä…czenia z API (Prawdziwy OFF):', e);
Â  Â  Â  // JeÅ›li bÅ‚Ä…d, to znaczy, Å¼e serwer jest niedostÄ™pny
Â  Â  Â  document.getElementById('status').innerText='ðŸ”´ OFFLINE';Â 
      // WysyÅ‚amy webhooka tylko jeÅ›li ostatni znany stan to nie byÅ‚ offline
      if (lastOnline === true) {
          sendDiscord('ðŸ”´ **NeoNCraf OFFLINE**\nSerwer zostaÅ‚ wyÅ‚Ä…czony lub wystÄ…piÅ‚ bÅ‚Ä…d API.');
      }
      lastOnline = false;
Â  Â  Â  document.getElementById('players').innerText='-';
Â  Â  Â  document.getElementById('percent').innerText='';
Â  Â  });
}
fetchStatus();
setInterval(fetchStatus,1000);

/**
Â * FUNKCJA sendDiscord
Â */
function sendDiscord(msg){
Â  // URL podany przez Ciebie:
Â  const webhook = 'https://discordapp.com/api/webhooks/1450217665359642624/X9P7XIyJtZvQ7Ncqi0tn0_C3Qh4caj4S2gpB6Wm99lc4q8hZXgdEpkdD5wwoPz1jys6e';Â 

Â  fetch(webhook, {
Â  Â  method: 'POST',
Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  body: JSON.stringify({ content: msg })
Â  })
Â  .then(response => {
Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  console.error('BÅ‚Ä…d wysyÅ‚ania webhooka. Prawdopodobnie URL jest nieaktywny lub skasowany (status: ' + response.status + ').', response.statusText);
Â  Â  Â  }
Â  })
Â  .catch(error => {
Â  Â  Â  console.error('BÅ‚Ä…d poÅ‚Ä…czenia webhooka (sieÄ‡):', error);
Â  });
}

// language
let lang = navigator.language && navigator.language.startsWith('pl') ? 'pl' : 'en';
function toggleLang(){
Â  lang = lang==='pl'?'en':'pl';
Â  applyLang();
}
function applyLang(){
Â  document.querySelectorAll('[data-pl]').forEach(e=>{
Â  Â  e.innerText = e.dataset[lang];
Â  });
}
applyLang();
</script>
</body>
</html>
